"use strict";(self.webpackChunkquan_ly_cua_hang=self.webpackChunkquan_ly_cua_hang||[]).push([[612],{1137:(t,e,n)=>{n.d(e,{x:()=>i});let i=function(t){return t.MODAL_EDIT_PRODUCT="MODAL_EDIT_PRODUCT",t.MODAL_DELETE_PRODUCT="MODAL_DELETE_PRODUCT",t.UNSAVE_CHANGE_PRODUCT="UNSAVE_CHANGE_PRODUCT",t.UPLOAD_IMAGE_MODAL="UPLOAD_IMAGE_MODAL",t}({})},1481:(t,e,n)=>{n.d(e,{Z:()=>i});const i=t=>{document.title=t}},375:(t,e,n)=>{n.d(e,{h:()=>d});var i=n(942);const l=(t=>{let e=t;const n=new Set;return{getState:()=>e,setState:t=>{e=t(e),n.forEach((t=>t()))},subscribe:t=>(n.add(t),()=>n.delete(t)),resetState:()=>{e=t}}})({}),d=()=>({state:((t,e)=>{const n=(0,i.useSyncExternalStore)(t.subscribe,(()=>JSON.stringify(e(t.getState()))),(()=>JSON.stringify(e(t.getState())))),[l,d]=(0,i.useState)(JSON.parse(n||""));return(0,i.useEffect)((()=>{d(JSON.parse(n||""))}),[n]),l})(l,(t=>t)),openModal:(t,e)=>{t&&l.setState((n=>({...n,[t]:{...e,active:!0}})))},closeModal:function(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";t&&l.setState((e=>({...e,[t]:{active:!1}})))}})},1612:(t,e,n)=>{n.r(e),n.d(e,{default:()=>w});var i=n(942),l=n(3125),d=n(6940),o=n(4182),a=n(4237),s=n(6275),r=n(9975),c=n(1826),u=n(4397),v=n.n(u),p=n(4837),h=n(898),x=n(7331),g=n(6173),m=n(8275),y=n(6620),S=n(9449),j=n(8195),A=n(6881),f=n(6534),b=n(1015),C=n(93),E=n(446);const T=t=>{var e,n,l,d;let{open:o,setOpen:a,handleUpdateItem:s,data:r}=t;const[u,v]=(0,i.useState)([]),[p,h]=(0,i.useState)(r),[x,m]=(0,i.useState)(null===r||void 0===r?void 0:r.product),[A,f]=(0,i.useState)([]),[b,T]=(0,i.useState)((null===r||void 0===r||null===(e=r.product)||void 0===e||null===(n=e.category)||void 0===n?void 0:n.id.toString())||""),[D,O]=(0,i.useState)(null!==r&&void 0!==r&&r.id?[null===r||void 0===r?void 0:r.product]:[]);(0,i.useEffect)((()=>{(async()=>{var t,e,n,i;const l=await c.A.get("http://54.199.68.197:8081/api/v1/products");v(null===l||void 0===l||null===(t=l.data)||void 0===t||null===(e=t.data)||void 0===e?void 0:e.data);const d=null===l||void 0===l||null===(n=l.data)||void 0===n||null===(i=n.data)||void 0===i?void 0:i.data.filter((t=>t.category.id.toString()===b));O(d),m(d[0]),h({id:r.id,product:d[0],quantity:r.quantity})})()}),[b]),(0,i.useEffect)((()=>{(async()=>{var t,e,n,i;const l=await c.A.get("http://54.199.68.197:8081/api/v1/category",{params:{page:0,size:1e3}});f(null===l||void 0===l||null===(t=l.data)||void 0===t||null===(e=t.data)||void 0===e?void 0:e.data),r||T(null===l||void 0===l||null===(n=l.data)||void 0===n||null===(i=n.data)||void 0===i?void 0:i.data[0].id.toString())})()}),[]);return(0,E.jsx)(g.a,{size:"small",open:o,onClose:()=>a(!1),title:null!==r&&void 0!==r&&r.id?"S\u1eeda th\xf4ng tin m\u1eb7t h\xe0ng":"Th\xeam M\u1eb7t H\xe0ng",primaryAction:{content:null!==r&&void 0!==r&&r.id?"L\u01b0u":"Th\xeam",onAction:()=>s(p,null===r||void 0===r?void 0:r.id)},secondaryActions:[{content:"H\u1ee7y",onAction:()=>a(!1)}],children:(0,E.jsx)(C.l,{onSubmit:()=>s(p,null===r||void 0===r?void 0:r.id),children:(0,E.jsx)(g.a.Section,{children:(0,E.jsxs)(y.H,{children:[(0,E.jsx)(j.l,{id:"select-category",label:"Ch\u1ecdn lo\u1ea1i m\u1eb7t h\xe0ng",options:A.map((t=>({label:t.name,value:t.id.toString()}))),value:b,onChange:t=>(t=>{T(t)})(t),disabled:!(null===r||void 0===r||!r.id)}),(0,E.jsx)(j.l,{id:"select-product",label:"Ch\u1ecdn m\u1eb7t h\xe0ng",options:D.map((t=>({label:t.name,value:t.id?t.id.toString():""}))),value:(null===x||void 0===x||null===(l=x.id)||void 0===l?void 0:l.toString())||"",onChange:t=>(t=>{const e=u.find((e=>e.id===parseInt(t)));e&&(m(e),h({...p,product:e}))})(t),disabled:!(null===r||void 0===r||!r.id)}),(0,E.jsx)(S.A,{id:"quantity",label:"S\u1ed1 L\u01b0\u1ee3ng",type:"number",min:1,value:null!==p&&void 0!==p&&p.quantity?null===p||void 0===p||null===(d=p.quantity)||void 0===d?void 0:d.toString():"",onChange:t=>(t=>{h({...p,quantity:parseInt(t)})})(t),disabled:!b,autoComplete:"off"}),(0,E.jsx)(S.A,{id:"price",label:"Gi\xe1",type:"number",value:null===x||void 0===x?void 0:x.price.toString(),disabled:!0,autoComplete:"off"})]})})})})},D=t=>{var e;let{open:n,setOpen:l,order:d,fetchData:a,setSelectedRows:u}=t;const[C,D]=(0,i.useState)("5"),[O,_]=(0,i.useState)(!1),[M,P]=(0,i.useState)(!1),[L,w]=(0,i.useState)(!1),[q,k]=(0,i.useState)([]),[R,U]=(0,i.useState)(0),[Y,N]=(0,i.useState)(!1),[I,H]=(0,i.useState)(),[G,$]=(0,i.useState)(d||{createdAt:v()().format("YYYY-MM-DD"),status:!1,supplier:{id:0,name:""},orderProducts:[],tax:.05,note:"",code:""}),[V,z]=(0,i.useState)(null===d||void 0===d||null===(e=d.supplier)||void 0===e?void 0:e.id.toString());(0,i.useEffect)((()=>{(async()=>{var t,e;const n=await c.A.get("http://54.199.68.197:8081/api/v1/suppliers",{params:{page:0,size:100}});k(null===n||void 0===n||null===(t=n.data)||void 0===t||null===(e=t.data)||void 0===e?void 0:e.data)})()}),[]),(0,i.useEffect)((()=>{U(B())}),[G]);const B=()=>{var t;return null===G||void 0===G||null===(t=G.orderProducts)||void 0===t?void 0:t.reduce(((t,e)=>t+e.quantity*e.product.price),0)},J=t=>{G&&G.orderProducts&&$({...G,orderProducts:G.orderProducts.filter((e=>t.id!==e.id))})},X=t=>{H(t),N(!0)};return(0,E.jsxs)("div",{children:[Y&&(0,E.jsx)(T,{handleUpdateItem:(t,e)=>{if(null!==t&&void 0!==t&&t.product&&null!==t&&void 0!==t&&t.quantity){var n;_(!1),N(!1);let i=!1;const l=null===G||void 0===G||null===(n=G.orderProducts)||void 0===n?void 0:n.map((n=>n.product.id===t.product.id||n.id===e?(i=!0,t):n));$({...G,orderProducts:e||i?l:G?[...null===G||void 0===G?void 0:G.orderProducts,t]:[t]})}else alert("Vui l\xf2ng \u0111i\u1ec1n \u0111\u1ea7y \u0111\u1ee7 th\xf4ng tin")},data:I,open:Y,setOpen:N}),(0,E.jsx)(g.a,{size:"large",title:null!==d&&void 0!==d&&d.id?"S\u1eeda th\xf4ng tin \u0111\u01a1n h\xe0ng":"T\u1ea1o \u0111\u01a1n nh\u1eadp h\xe0ng",open:n,onClose:()=>l(!1),primaryAction:{content:null!==G&&void 0!==G&&G.status?"\u0110\u01a1n h\xe0ng \u0111\xe3 thanh to\xe1n":"L\u01b0u",onAction:async()=>{var t;if(!(()=>{var t,e;let n=!0;return 0===(null===G||void 0===G||null===(t=G.orderProducts)||void 0===t?void 0:t.length)&&(_(!0),n=!1),0===(null===G||void 0===G?void 0:G.code.length)&&(P(!0),n=!1),null!==G&&void 0!==G&&null!==(e=G.supplier)&&void 0!==e&&e.id||(w(!0),n=!1),n})())return;const e=null===G||void 0===G||null===(t=G.orderProducts)||void 0===t?void 0:t.map((t=>({id:t.product.id,quantity:t.quantity})));if(null!==d&&void 0!==d&&d.id)try{var n;await c.A.put("http://54.199.68.197:8081/api/v1/orders/".concat(d.id),{code:null===G||void 0===G?void 0:G.code,note:null===G||void 0===G?void 0:G.note,taxType:null===G||void 0===G?void 0:G.tax,supplier:{id:null===G||void 0===G||null===(n=G.supplier)||void 0===n?void 0:n.id},products:e},{params:{page:0,size:1e3}}),a(),l(!1),u([])}catch(o){alert(o.response.data.message)}else{const t={...G,supplier:{id:null===G||void 0===G?void 0:G.supplier.id},products:G.orderProducts.map((t=>({id:t.product.id,quantity:t.quantity}))),status:!1};try{var i;const e=await c.A.post("http://54.199.68.197:8081/api/v1/orders",t);200===(null===e||void 0===e||null===(i=e.data)||void 0===i?void 0:i.status)&&(a(),l(!1))}catch(o){alert(o.response.data.message)}}},disabled:null===G||void 0===G?void 0:G.status},secondaryActions:[{content:"H\u1ee7y",onAction:()=>l(!1)}],children:(0,E.jsx)(g.a.Section,{children:(0,E.jsxs)(m.x,{children:[(0,E.jsx)(m.x.Cell,{columnSpan:{lg:8,md:4,xs:6},children:(0,E.jsxs)(y.H,{children:[(0,E.jsxs)(m.x,{children:[(0,E.jsx)(m.x.Cell,{columnSpan:{xs:6},children:(0,E.jsx)(S.A,{label:"Ng\xe0y t\u1ea1o \u0111\u01a1n",type:"date",value:v()(null===G||void 0===G?void 0:G.createdAt).format("YYYY-MM-DD"),disabled:!0,autoComplete:"off",id:"order-date"})}),(0,E.jsxs)(m.x.Cell,{columnSpan:{xs:6},children:[(0,E.jsx)(S.A,{label:"M\xe3 v\u1eadn \u0111\u01a1n",type:"text",value:null===G||void 0===G?void 0:G.code,onChange:t=>{$({...G,code:t}),P(!1)},autoComplete:"off",id:"delivery-code",disabled:null===G||void 0===G?void 0:G.status,requiredIndicator:!0}),M&&(0,E.jsx)(h.E,{tone:"critical",as:"p",children:"Vui l\xf2ng nh\u1eadp m\xe3 v\u1eadn \u0111\u01a1n"})]})]}),(0,E.jsxs)("div",{children:[(0,E.jsx)(j.l,{disabled:null===G||void 0===G?void 0:G.status,id:"supplier-select",label:"Nh\xe0 cung c\u1ea5p",options:q.map((t=>({label:t.name||"",value:t.id.toString()}))),value:V,onChange:t=>{(t=>{z(t),$({...G,supplier:{id:t,name:""}})})(t),w(!1)},placeholder:"Ch\u1ecdn nh\xe0 cung c\u1ea5p",requiredIndicator:!0}),L&&(0,E.jsx)(h.E,{tone:"critical",as:"p",children:"Vui l\xf2ng ch\u1ecdn nh\xe0 cung c\u1ea5p"})]}),(0,E.jsx)(S.A,{id:"note",label:"Ghi ch\xfa",value:null===G||void 0===G?void 0:G.note,onChange:t=>{t.length<=500&&$({...G,note:t})},multiline:3,autoComplete:"off",maxLength:200,showCharacterCount:!0,disabled:null===G||void 0===G?void 0:G.status})]})}),(0,E.jsxs)(m.x.Cell,{columnSpan:{xs:6,md:2,lg:4},children:[(0,E.jsx)("div",{style:{marginBottom:"15px"},children:(0,E.jsx)(S.A,{id:"total-product-price",label:"T\u1ed5ng ti\u1ec1n h\xe0ng ho\xe1",value:null===R||void 0===R?void 0:R.toString(),disabled:!0,autoComplete:""})}),(0,E.jsx)("div",{style:{marginBottom:"15px"},children:(0,E.jsx)(j.l,{id:"tax-select",label:"Ch\u1ecdn m\u1ee9c thu\u1ebf",value:C,options:[{label:"5%",value:"0.05"},{label:"10%",value:"0.1"}],onChange:t=>D(t),disabled:null===G||void 0===G?void 0:G.status})}),(0,E.jsx)("div",{style:{marginBottom:"15px"},children:(0,E.jsx)(S.A,{id:"tax",label:"Gi\xe1 tr\u1ecb thu\u1ebf",value:R?(parseFloat(C)*R).toString():"0",autoComplete:""})}),(0,E.jsx)(S.A,{id:"total",label:"T\u1ed5ng h\xf3a \u0111\u01a1n",value:R?(parseFloat(C)*R+R).toString():"0",disabled:!0,autoComplete:""})]}),(0,E.jsxs)(m.x.Cell,{columnSpan:{xs:6,md:6,lg:12},children:[(0,E.jsxs)(A.o,{gap:"400",children:[(0,E.jsx)(o.$,{disabled:null===G||void 0===G?void 0:G.status,onClick:()=>{N(!0),H(void 0)},id:"add-order-product-btn",children:"Th\xeam m\u1eb7t h\xe0ng"}),O&&(0,E.jsx)(h.E,{tone:"critical",as:"p",children:"Vui l\xf2ng nh\u1eadp s\u1ea3n ph\u1ea9m"})]}),(0,E.jsx)(s.b,{columnContentTypes:["text","numeric","text","numeric","numeric","text"],headings:["T\xean m\u1eb7t h\xe0ng",(0,E.jsx)("div",{style:{textAlign:"center"},children:"S\u1ed1 l\u01b0\u1ee3ng"}),"Lo\u1ea1i","Gi\xe1","T\u1ed5ng ti\u1ec1n","Thao t\xe1c"],rows:(Z=G,Z&&Z.orderProducts?Z.orderProducts.map((t=>[(0,E.jsxs)(p.a,{id:"product-name-and-image",children:[(0,E.jsx)(h.E,{id:"product-name",as:"p",children:t.product.name}),(0,E.jsx)(x.V,{source:t.product.image,alt:"image"})]}),(0,E.jsx)("div",{style:{textAlign:"center"},children:t.quantity}),t.product.category.name,t.product.price,t.product.price*t.quantity,(0,E.jsx)("div",{style:{minWidth:"70px"},children:(0,E.jsxs)(r.e,{children:[(0,E.jsx)(o.$,{icon:f.S,onClick:()=>X(t),id:"edit-order-product-btn",disabled:null===G||void 0===G?void 0:G.status}),(0,E.jsx)(o.$,{icon:b.S,tone:"critical",onClick:()=>J(t),id:"delete-order-product-btn",disabled:null===G||void 0===G?void 0:G.status})]})})])):[])})]})]})})})]});var Z};var O=n(5396),_=n(7921),M=n(375),P=n(1137),L=n(1481);const w=()=>{const{openModal:t}=(0,M.h)(),[e,n]=(0,i.useState)(!1),[u,p]=(0,i.useState)([]),[h,x]=(0,i.useState)([]),[g,m]=(0,i.useState)(),[y,S]=(0,i.useState)(0),[j,A]=(0,i.useState)([]);(0,L.Z)("Qu\u1ea3n l\xfd \u0111\u01a1n nh\u1eadp h\xe0ng");const f=(0,O.Zp)(),b=["",(0,E.jsx)("div",{style:{textAlign:"center"},children:"STT"}),(0,E.jsx)("div",{style:{textAlign:"center"},children:"M\xe3 \u0111\u01a1n h\xe0ng"}),(0,E.jsx)("div",{style:{textAlign:"left"},children:"Ng\xe0y t\u1ea1o"}),(0,E.jsx)("div",{style:{textAlign:"left"},children:"Nh\xe0 cung c\u1ea5p"}),(0,E.jsx)("div",{style:{textAlign:"left"},children:"Tr\u1ea1ng th\xe1i"})],C=()=>{c.A.get("http://54.199.68.197:8081/api/v1/orders",{params:{page:0,size:1e4}}).then((t=>{if(200===t.status){var e,n;const i=null===t||void 0===t||null===(e=t.data)||void 0===e||null===(n=e.data)||void 0===n?void 0:n.data;p(i),x(i.slice(0,10))}})).catch((t=>console.error(t)))};(0,i.useEffect)((()=>{C()}),[e,y,j]);const T=t=>{const e=y+t;S(e),x(u.slice(10*e,10*(e+1)))};return(0,E.jsxs)(d.Y,{backAction:{onAction:()=>f("/quan-ly-cua-hang")},title:"Qu\u1ea3n l\xfd \u0111\u01a1n h\xe0ng",primaryAction:{content:"T\u1ea1o \u0111\u01a1n h\xe0ng",onAction:()=>(m(void 0),void n(!0))},fullWidth:!0,children:[(0,E.jsx)("div",{style:{marginBottom:"20px"},children:(0,E.jsx)(o.$,{onClick:()=>A([]),disabled:!j.length,children:"B\u1ecf ch\u1ecdn"})}),(0,E.jsx)(a.Z,{children:(0,E.jsx)(s.b,{columnContentTypes:["text","text","text","text","text"],headings:b,rows:(w=h,w.map(((t,e)=>[(0,E.jsx)(l.S,{name:"",value:"",label:"",labelHidden:!0,checked:!!j.find((e=>e===t.id)),onChange:e=>{A(e?e=>[...e,t.id]:e=>e.filter((e=>e!==t.id)))}}),(0,E.jsx)("div",{style:{textAlign:"center"},children:10*y+e+1}),(0,E.jsx)("div",{style:{textAlign:"center"},children:t.id}),v()(t.createdAt).format("YYYY-MM-DD"),t.supplier.name,t.status?"\u0110\xe3 thanh to\xe1n":"Ch\u01b0a thanh to\xe1n"]))),truncate:!0})}),(0,E.jsx)("div",{style:{display:"flex",justifyContent:"center",marginTop:"20px"},children:(0,E.jsxs)(r.e,{children:[(0,E.jsx)(o.$,{disabled:0===y,onClick:()=>T(-1),id:"previous-page",children:"Trang tr\u01b0\u1edbc"}),(0,E.jsx)(o.$,{disabled:u.length<10*(y+1),onClick:()=>T(1),id:"next-page",children:"Trang ti\u1ebfp theo"})]})}),j.length>0&&(0,E.jsxs)("div",{style:{position:"absolute",left:"50%",bottom:"15px",background:"#fff",paddingBlock:8,paddingInline:12,borderRadius:8,border:"1px solid #f1f1f1",transform:"translateX(-50%)",display:"flex",gap:"12px"},children:[(0,E.jsx)(o.$,{variant:"primary",disabled:j.length>1,onClick:()=>{const t=u.find((t=>t.id===j[0]));m(t),n(!0)},children:"S\u1eeda \u0111\u01a1n h\xe0ng"}),(0,E.jsx)(o.$,{variant:"primary",tone:"critical",onClick:()=>{t(P.x.MODAL_DELETE_PRODUCT,{data:{selectedRows:j,setSelectedRows:A}})},children:"Xo\xe1 \u0111\u01a1n h\xe0ng"})]}),e&&(0,E.jsx)(D,{order:g,open:e,setOpen:n,fetchData:C,setSelectedRows:A}),(0,E.jsx)(_.A,{selectedRows:j,setSelectedRows:A,type:"orders"})]});var w}},7921:(t,e,n)=>{n.d(e,{A:()=>u});var i=n(6173),l=n(8597),d=n(898),o=n(375),a=n(1137),s=n(942),r=n(1826),c=n(446);const u=t=>{var e;let{selectedRows:n=[],setSelectedRows:u=(()=>{}),type:v}=t;const{state:p,closeModal:h}=(0,o.h)(),[x,g]=(0,s.useState)(!1),m=()=>{h(a.x.MODAL_DELETE_PRODUCT)};return(0,c.jsx)(i.a,{open:null===(e=p[a.x.MODAL_DELETE_PRODUCT])||void 0===e?void 0:e.active,title:"X\xe1c nh\u1eadn xo\xe1 ".concat(n.length," m\u1eb7t h\xe0ng"),onClose:m,primaryAction:{content:"X\xe1c nh\u1eadn",onAction:()=>{g(!0),n.forEach(((t,e)=>{(async t=>{await r.A.delete("http://54.199.68.197:8081/api/v1/".concat(v,"/").concat(t)).then((t=>console.log(t))).catch((t=>console.log(t))),u([])})(t).then((()=>{e===n.length-1&&(g(!1),m())}))}))},loading:x},secondaryActions:[{content:"Hu\u1ef7",onAction:()=>{m()}}],children:(0,c.jsx)(i.a.Section,{children:(0,c.jsxs)(l.a,{gap:"300",children:[(0,c.jsx)(d.E,{as:"p",variant:"bodyMd",children:"M\u1eb7t h\xe0ng \u0111\xe3 xo\xe1 s\u1ebd kh\xf4ng th\u1ec3 kh\xf4i ph\u1ee5c l\u1ea1i."}),(0,c.jsx)(d.E,{as:"p",variant:"bodyMd",children:"Ti\u1ebfp t\u1ee5c xo\xe1?"})]})})})}}}]);
//# sourceMappingURL=612.6c1a8128.chunk.js.map